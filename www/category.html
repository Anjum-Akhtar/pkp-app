<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css">
  
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="fontawesome/css/all.min.css">
        
        <title>PKP APP</title>
    </head>
    <body>
        <div class="header"></div> 

        <div class="container category-page">
            <div class="row my-5" id="cat-product">  
                <h2>Category: <span class="cat"></span></h2>
            </div>
        </div>


        <script src="js/jquery-3.7.1.min.js"></script> 
        <script src="js/bootstrap.bundle.min.js"></script> 
        <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script> 
        <script src="js/jquery.validate.min.js"></script> 
        <script src="js/index.js"></script>
        <script src="js/custom.js"></script> 
        <script> 
            $(function() {   
                // var pathname = window.location.pathname; // Returns path only (/path/example.html)
                // var url      = window.location.href;     // Returns full URL (https://example.com/path/example.html)
                // var origin   = window.location.origin; // Returns base origin https://example.com
                // var cat_name = url.substring(url.lastIndexOf('=') + 1); 
                var urlParams = new URLSearchParams(window.location.search);
                var cat_name = urlParams.get('cat-name');
                // console.log("cat name",cat_name);
                var pro_detail = {
                        request_type:"getProducts", 
                        cat_name:cat_name     
                    }
                var json_str = JSON.stringify(pro_detail); 
                $.ajax({  
                    url: API_URL+'getProducts.php',   
                    method:'POST',   
                    data:json_str,
                    contentType: 'application/json',
                    success: function(data) {   
                        var res_data =  JSON.parse(data);    
                        $('.cat').append(cat_name);
                        $.each(res_data.data,function(index,item){  
                            $('#cat-product').append(
                                '<div class="col-6 my-3">\
                                    <div class="img-box">\
                                        <img class="wishlist-icon" src="images/heart-regular.svg" alt="Icon">\
                                        <a href="product-detail.html?pro-id='+item.product_id+'">\
                                        <img class="w-100" src="'+img_path+item.product_img1+'" alt="Image">\
                                        </a>\
                                    </div>\
                                    <div class="text-box">\
                                        <a href="product-detail.html?pro-id='+item.product_id+'">\
                                        <p>'+item.product_name+'</p>\
                                        </a>\
                                        <span class="sale">&#8377; '+item.regular_price+'</span>\
                                        <span>&#8377; '+item.sale_price+'</span>\
                                    </div>\
                                </div>'
                            );   
                        })
                    },  
                    error: function(xhr, textStatus, errorThrown) {  
                        console.log('Error in Database');  
                    }  
                });  
            });  


           
            header();
        </script>

    </body>
</html>